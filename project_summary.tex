\documentclass[12pt,a4paper]{article}
\usepackage[UTF8]{ctex}
\usepackage{geometry}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{hyperref}
\usepackage{fontawesome5}
\usepackage{tikz}
\usepackage{tcolorbox}
\usepackage{enumitem}
\usepackage{fancyhdr}
\usepackage{titlesec}

% é¡µé¢è®¾ç½®
\geometry{left=2.5cm, right=2.5cm, top=2.5cm, bottom=2.5cm}

% é¢œè‰²å®šä¹‰
\definecolor{primaryblue}{RGB}{41, 128, 185}
\definecolor{secondarygreen}{RGB}{39, 174, 96}
\definecolor{warningorange}{RGB}{230, 126, 34}
\definecolor{codebg}{RGB}{245, 245, 245}
\definecolor{codeframe}{RGB}{200, 200, 200}

% ä»£ç æ ·å¼
\lstset{
    basicstyle=\ttfamily\small,
    backgroundcolor=\color{codebg},
    frame=single,
    framerule=0.5pt,
    rulecolor=\color{codeframe},
    breaklines=true,
    breakatwhitespace=true,
    showstringspaces=false,
    tabsize=4,
    captionpos=b,
    numbers=none,
    xleftmargin=10pt,
    xrightmargin=10pt,
    aboveskip=10pt,
    belowskip=10pt
}

% æ ‡é¢˜æ ·å¼
\titleformat{\section}{\Large\bfseries\color{primaryblue}}{\thesection}{1em}{}
\titleformat{\subsection}{\large\bfseries\color{primaryblue!80}}{\thesubsection}{1em}{}

% é¡µçœ‰é¡µè„š
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\textcolor{gray}{æ–°å·¥ç§‘ AI åŠ©æ•™ç³»ç»Ÿ}}
\fancyhead[R]{\textcolor{gray}{é¡¹ç›®æŠ€æœ¯æ€»ç»“}}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}

% tcolorbox æ ·å¼
\tcbuselibrary{skins,breakable}

\newtcolorbox{highlightbox}[1][]{
    colback=primaryblue!5,
    colframe=primaryblue,
    fonttitle=\bfseries,
    title=#1,
    breakable
}

\newtcolorbox{tipbox}[1][]{
    colback=secondarygreen!5,
    colframe=secondarygreen,
    fonttitle=\bfseries,
    title=#1,
    breakable
}

\newtcolorbox{warningbox}[1][]{
    colback=warningorange!5,
    colframe=warningorange,
    fonttitle=\bfseries,
    title=#1,
    breakable
}

\begin{document}

% å°é¢
\begin{titlepage}
    \centering
    \vspace*{2cm}
    
    {\Huge\bfseries\color{primaryblue} ğŸ“ æ–°å·¥ç§‘ AI åŠ©æ•™ç³»ç»Ÿ}
    
    \vspace{0.5cm}
    {\Large\color{gray} é¡¹ç›®æŠ€æœ¯æ€»ç»“æŠ¥å‘Š}
    
    \vspace{2cm}
    
    \begin{tcolorbox}[
        colback=white,
        colframe=primaryblue,
        width=0.8\textwidth,
        arc=5mm
    ]
        \centering
        \large
        åŸºäº \textbf{RAG-Anything} æ¡†æ¶æ„å»ºçš„\\[0.5em]
        å¤šæ¨¡æ€æ™ºèƒ½é—®ç­”ç³»ç»Ÿ
    \end{tcolorbox}
    
    \vspace{2cm}
    
    \begin{tabular}{rl}
        \textbf{æ–‡æœ¬æ¨¡å‹:} & DeepSeek (deepseek-chat) \\[0.5em]
        \textbf{è§†è§‰æ¨¡å‹:} & é˜¿é‡Œé€šä¹‰ Qwen-VL-Max \\[0.5em]
        \textbf{åµŒå…¥æ¨¡å‹:} & BGE-Small-ZH (æœ¬åœ°) \\[0.5em]
        \textbf{RAGæ¡†æ¶:} & LightRAG + çŸ¥è¯†å›¾è°± \\
    \end{tabular}
    
    \vfill
    
    {\large \today}
    
\end{titlepage}

% ç›®å½•
\tableofcontents
\newpage

% ========== æ­£æ–‡ ==========

\section{é¡¹ç›®æ¦‚è¿°}

æœ¬é¡¹ç›®åŸºäº \textbf{RAG-Anything} æ¡†æ¶æ„å»ºäº†ä¸€ä¸ªå¤šæ¨¡æ€ AI åŠ©æ•™ç³»ç»Ÿï¼Œèƒ½å¤Ÿï¼š

\begin{itemize}[leftmargin=2em]
    \item è§£æ PDF æ•™æä¸­çš„\textbf{æ–‡æœ¬ã€å›¾ç‰‡ã€è¡¨æ ¼å’Œå…¬å¼}
    \item æ„å»º\textbf{çŸ¥è¯†å›¾è°±}è¿›è¡Œè¯­ä¹‰æ£€ç´¢
    \item æä¾›\textbf{ä¸ªæ€§åŒ–æ™ºèƒ½é—®ç­”}åŠŸèƒ½
    \item æ”¯æŒ\textbf{å¤šå›¾ç‰‡æ‰¹é‡å¤„ç†}
\end{itemize}

\begin{highlightbox}[æ ¸å¿ƒç‰¹æ€§]
\begin{itemize}
    \item \textbf{åŒæ¨¡å‹åä½œ}ï¼šæ–‡æœ¬å¤„ç†ä½¿ç”¨ DeepSeekï¼Œå›¾åƒç†è§£ä½¿ç”¨ Qwen-VL
    \item \textbf{æ™ºèƒ½åˆ†æ‰¹}ï¼šè‡ªåŠ¨å°†å¤§é‡å›¾ç‰‡åˆ†æ‰¹å¤„ç†ï¼Œçªç ´ API é™åˆ¶
    \item \textbf{ä¼˜é›…é™çº§}ï¼šVLM è°ƒç”¨å¤±è´¥æ—¶è‡ªåŠ¨å›é€€åˆ°çº¯æ–‡æœ¬æ¨¡å¼
\end{itemize}
\end{highlightbox}

\section{å¤§æ¨¡å‹æ¶æ„}

\subsection{åŒæ¨¡å‹åä½œè®¾è®¡}

ç³»ç»Ÿé‡‡ç”¨\textbf{æ–‡æœ¬æ¨¡å‹ + è§†è§‰æ¨¡å‹}çš„åŒæ¨¡å‹åä½œæ¶æ„ï¼š

\begin{center}
\begin{tikzpicture}[
    node distance=1.5cm,
    box/.style={rectangle, draw=primaryblue, fill=primaryblue!10, 
                text width=3cm, text centered, rounded corners, minimum height=1cm},
    arrow/.style={->, thick, primaryblue}
]
    % èŠ‚ç‚¹
    \node[box] (query) {ç”¨æˆ·æŸ¥è¯¢};
    \node[box, below of=query] (rag) {RAG æ£€ç´¢\\(LightRAG)};
    \node[box, below left=1.5cm and 0.5cm of rag] (text) {æ–‡æœ¬å¤„ç†\\DeepSeek};
    \node[box, below right=1.5cm and 0.5cm of rag] (vision) {å›¾åƒå¤„ç†\\Qwen-VL};
    \node[box, below=3.5cm of rag] (output) {ç»¼åˆå›ç­”ç”Ÿæˆ};
    
    % ç®­å¤´
    \draw[arrow] (query) -- (rag);
    \draw[arrow] (rag) -- (text);
    \draw[arrow] (rag) -- (vision);
    \draw[arrow] (text) -- (output);
    \draw[arrow] (vision) -- (output);
\end{tikzpicture}
\end{center}

\subsection{æ¨¡å‹é€‰å‹}

\begin{table}[htbp]
\centering
\caption{æ¨¡å‹é…ç½®è¯¦æƒ…}
\begin{tabular}{@{}llll@{}}
\toprule
\textbf{åŠŸèƒ½} & \textbf{æ¨¡å‹} & \textbf{æä¾›å•†} & \textbf{ç‰¹ç‚¹} \\
\midrule
æ–‡æœ¬ç†è§£/ç”Ÿæˆ & deepseek-chat & DeepSeek & ä¸­æ–‡èƒ½åŠ›å¼ºã€æ€§ä»·æ¯”é«˜ \\
å›¾åƒç†è§£ & qwen-vl-max & é˜¿é‡Œäº‘ & æ”¯æŒå¤šå›¾(10å¼ )ã€ä¸­æ–‡OCRå¼º \\
æ–‡æœ¬åµŒå…¥ & bge-small-zh-v1.5 & æœ¬åœ° & 512ç»´å‘é‡ã€ç¦»çº¿å¯ç”¨ \\
\bottomrule
\end{tabular}
\end{table}

\section{æŠ€æœ¯äº®ç‚¹}

\subsection{äº®ç‚¹ä¸€ï¼šæ™ºèƒ½å›¾ç‰‡åˆ†æ‰¹å¤„ç†}

å½“ PDF ä¸­çš„å›¾ç‰‡æ•°é‡è¶…è¿‡ VLM å•æ¬¡è¯·æ±‚é™åˆ¶æ—¶ï¼Œç³»ç»Ÿè‡ªåŠ¨è¿›è¡Œåˆ†æ‰¹å¤„ç†ï¼š

\begin{lstlisting}[language=Python, caption=åˆ†æ‰¹å¤„ç†æµç¨‹]
# å½“å›¾ç‰‡è¶…è¿‡å•æ¬¡é™åˆ¶æ—¶è‡ªåŠ¨åˆ†æ‰¹
# æ£€æµ‹åˆ° 25 å¼ å›¾ç‰‡ï¼Œæ¯æ‰¹æœ€å¤š 10 å¼ 
# å°† 25 å¼ å›¾ç‰‡åˆ†æˆ 3 æ‰¹å¤„ç†
# æ­£åœ¨å¤„ç†ç¬¬ 1/3 æ‰¹...
# æ­£åœ¨å¤„ç†ç¬¬ 2/3 æ‰¹...
# æ­£åœ¨å¤„ç†ç¬¬ 3/3 æ‰¹...
# æ­£åœ¨ç”¨ DeepSeek ç»¼åˆæ‰€æœ‰æ‰¹æ¬¡çš„åˆ†æç»“æœ...
\end{lstlisting}

\begin{tipbox}[è§£å†³çš„é—®é¢˜]
çªç ´ VLM API çš„å•æ¬¡å›¾ç‰‡æ•°é‡é™åˆ¶ï¼Œæ”¯æŒä»»æ„æ•°é‡å›¾ç‰‡çš„å®Œæ•´å¤„ç†ã€‚æ¯ä¸ªæ‰¹æ¬¡çš„åˆ†æç»“æœæœ€ç»ˆç”± DeepSeek ç»¼åˆæˆå®Œæ•´ç­”æ¡ˆã€‚
\end{tipbox}

\subsection{äº®ç‚¹äºŒï¼šDeepSeek å…¼å®¹æ€§é€‚é…}

LightRAG æ¡†æ¶é»˜è®¤ä½¿ç”¨ OpenAI çš„ \texttt{response\_format} ç»“æ„åŒ–è¾“å‡ºåŠŸèƒ½ï¼Œä½† DeepSeek ä¸æ”¯æŒæ­¤åŠŸèƒ½ã€‚

\begin{lstlisting}[language=Python, caption=å…¼å®¹æ€§å¤„ç†]
# è‡ªåŠ¨ç§»é™¤ DeepSeek ä¸æ”¯æŒçš„å‚æ•°
kwargs.pop('response_format', None)
kwargs.pop('keyword_extraction', None)
\end{lstlisting}

\textbf{ä¿®æ”¹ä½ç½®ï¼š}
\begin{itemize}
    \item \texttt{app.py} ä¸­çš„ \texttt{safe\_deepseek\_call} å’Œ \texttt{vision\_func}
    \item \texttt{lightrag/llm/openai.py} ä¸­çš„ DeepSeek æ£€æµ‹é€»è¾‘
\end{itemize}

\subsection{äº®ç‚¹ä¸‰ï¼šä¼˜é›…çš„é”™è¯¯å›é€€æœºåˆ¶}

\begin{lstlisting}[language=Python, caption=é”™è¯¯å›é€€é€»è¾‘]
try:
    # å°è¯•è°ƒç”¨ VLM
    response = await openai_complete_if_cache(vision_model, ...)
except Exception as e:
    # å¤±è´¥æ—¶è‡ªåŠ¨å›é€€åˆ°çº¯æ–‡æœ¬æ¨¡å¼
    print(f"VLM è°ƒç”¨å¤±è´¥: {e}ï¼Œå›é€€åˆ°çº¯æ–‡æœ¬æ¨¡å¼")
    return await safe_deepseek_call(text_prompt, ...)
\end{lstlisting}

\begin{warningbox}[è§£å†³çš„é—®é¢˜]
VLM è°ƒç”¨å¤±è´¥æ—¶ä¸ä¼šä¸­æ–­ç”¨æˆ·ä½“éªŒï¼Œè‡ªåŠ¨é™çº§åˆ°çº¯æ–‡æœ¬é—®ç­”ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§ã€‚
\end{warningbox}

\subsection{äº®ç‚¹å››ï¼šåŠ¨æ€æ¨¡å‹é…ç½®}

æ ¹æ®é…ç½®çš„è§†è§‰æ¨¡å‹æä¾›å•†è‡ªåŠ¨è°ƒæ•´å›¾ç‰‡æ•°é‡é™åˆ¶ï¼š

\begin{lstlisting}[language=Python, caption=åŠ¨æ€é…ç½®é€»è¾‘]
if vision_provider == "qwen":
    MAX_IMAGES_PER_REQUEST = 10   # é˜¿é‡Œ Qwen-VL
elif vision_provider == "siliconflow":
    MAX_IMAGES_PER_REQUEST = 10   # ç¡…åŸºæµåŠ¨
else:
    MAX_IMAGES_PER_REQUEST = 1    # æ™ºè°± GLM-4V
\end{lstlisting}

\subsection{äº®ç‚¹äº”ï¼šä¸ªæ€§åŒ–æ•™å­¦æ¨¡å¼}

ç³»ç»Ÿæ ¹æ®ç”¨æˆ·é€‰æ‹©çš„å­¦ä¹ æ°´å¹³è°ƒæ•´å›ç­”é£æ ¼ï¼š

\begin{table}[htbp]
\centering
\caption{æ•™å­¦æ¨¡å¼å¯¹æ¯”}
\begin{tabular}{@{}lll@{}}
\toprule
\textbf{æ¨¡å¼} & \textbf{ç›®æ ‡ç”¨æˆ·} & \textbf{å›ç­”é£æ ¼} \\
\midrule
ç›´è§‰ç§‘æ™®æ¨¡å¼ & åˆå­¦è€… & ç”¨ç”Ÿæ´»ç±»æ¯”è§£é‡Šæ¦‚å¿µ \\
æ ‡å‡†æ•™å­¦æ¨¡å¼ & æœ¬ç§‘ç”Ÿ & å®šä¹‰â†’å…¬å¼â†’ç‰©ç†æ„ä¹‰â†’è€ƒç‚¹ \\
æ·±åº¦ç ”è®¨æ¨¡å¼ & ä¸“å®¶ & å­¦æœ¯ç®€ç»ƒã€æ·±å…¥æœºåˆ¶ \\
\bottomrule
\end{tabular}
\end{table}

\section{é¡¹ç›®é…ç½®}

\subsection{ç¯å¢ƒå˜é‡é…ç½® (.env)}

\begin{lstlisting}[caption=.env é…ç½®æ–‡ä»¶]
# æ–‡æœ¬æ¨¡å‹ (DeepSeek)
LLM_BINDING_HOST=https://api.deepseek.com/v1
LLM_BINDING_API_KEY=sk-xxx
OPENAI_API_KEY=sk-xxx

# è§†è§‰æ¨¡å‹ (é˜¿é‡Œ Qwen-VL)
VISION_PROVIDER=qwen
QWEN_API_KEY=sk-xxx
\end{lstlisting}

\subsection{æ”¯æŒçš„è§†è§‰æ¨¡å‹}

\begin{table}[htbp]
\centering
\caption{å¯é€‰è§†è§‰æ¨¡å‹}
\begin{tabular}{@{}lllll@{}}
\toprule
\textbf{æä¾›å•†} & \textbf{æ¨¡å‹} & \textbf{å¤šå›¾æ”¯æŒ} & \textbf{é…ç½®} \\
\midrule
æ™ºè°± & glm-4v & 1å¼  & \texttt{VISION\_PROVIDER=zhipu} \\
\textbf{é˜¿é‡Œ} & qwen-vl-max & \textbf{10å¼ } & \texttt{VISION\_PROVIDER=qwen} \\
ç¡…åŸºæµåŠ¨ & Qwen2-VL-72B & 10å¼  & \texttt{VISION\_PROVIDER=siliconflow} \\
\bottomrule
\end{tabular}
\end{table}

\section{å…³é”®ä¿®æ”¹æ–‡ä»¶}

\begin{table}[htbp]
\centering
\caption{ä¿®æ”¹æ–‡ä»¶æ¸…å•}
\begin{tabular}{@{}lp{8cm}@{}}
\toprule
\textbf{æ–‡ä»¶} & \textbf{ä¿®æ”¹å†…å®¹} \\
\midrule
\texttt{app.py} & åŒæ¨¡å‹æ¶æ„ã€å›¾ç‰‡åˆ†æ‰¹å¤„ç†ã€é”™è¯¯å›é€€æœºåˆ¶ã€åŠ¨æ€é…ç½® \\
\texttt{lightrag/llm/openai.py} & DeepSeek \texttt{response\_format} å…¼å®¹æ€§ä¿®å¤ \\
\texttt{.env} & API å¯†é’¥å’Œæ¨¡å‹é…ç½® \\
\bottomrule
\end{tabular}
\end{table}

\section{è¿è¡ŒæŒ‡å—}

\subsection{å¯åŠ¨å‘½ä»¤}

\begin{lstlisting}[language=bash]
cd C:\RAG-Anything\RAG-Anything
.\venv\Scripts\activate
streamlit run app.py
\end{lstlisting}

\subsection{è®¿é—®åœ°å€}

\begin{itemize}
    \item æœ¬åœ°è®¿é—®: \url{http://localhost:8501}
    \item å±€åŸŸç½‘è®¿é—®: \url{http://ä½ çš„IP:8501}
\end{itemize}

\section{ç³»ç»Ÿæ¶æ„å›¾}

\begin{center}
\begin{tikzpicture}[
    node distance=0.8cm,
    layer/.style={rectangle, draw=primaryblue, fill=primaryblue!10, 
                  text width=12cm, text centered, rounded corners, minimum height=1.2cm},
    component/.style={rectangle, draw=gray, fill=gray!10, 
                      text width=3.5cm, text centered, rounded corners, minimum height=0.8cm}
]
    % å±‚çº§
    \node[layer] (ui) {\textbf{Streamlit Web UI}\\PDFä¸Šä¼  | é—®ç­”è¾“å…¥ | å­¦ä¹ æ¨¡å¼é€‰æ‹©};
    
    \node[layer, below=0.5cm of ui] (rag) {\textbf{RAGAnything æ¡†æ¶}\\MinerU è§£æ | LightRAG çŸ¥è¯†å›¾è°± | å¤šæ¨¡æ€å¤„ç†å™¨};
    
    \node[component, below left=0.8cm and 1cm of rag] (deepseek) {\textbf{DeepSeek}\\æ–‡æœ¬å¤„ç†\\å®ä½“æå–\\ç­”æ¡ˆç”Ÿæˆ};
    
    \node[component, below right=0.8cm and 1cm of rag] (qwen) {\textbf{Qwen-VL-Max}\\å›¾åƒå¤„ç†\\åˆ†æ‰¹å¤„ç†\\å†…å®¹ç†è§£};
    
    % è¿æ¥
    \draw[->, thick, primaryblue] (ui) -- (rag);
    \draw[->, thick, primaryblue] (rag) -- (deepseek);
    \draw[->, thick, primaryblue] (rag) -- (qwen);
\end{tikzpicture}
\end{center}

\section{æ€»ç»“}

æœ¬é¡¹ç›®æˆåŠŸå®ç°äº†ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„å¤šæ¨¡æ€ AI åŠ©æ•™ç³»ç»Ÿï¼Œä¸»è¦æŠ€æœ¯è´¡çŒ®åŒ…æ‹¬ï¼š

\begin{enumerate}[leftmargin=2em]
    \item \textbf{åŒæ¨¡å‹åä½œæ¶æ„}ï¼šDeepSeek è´Ÿè´£æ–‡æœ¬ï¼ŒQwen-VL è´Ÿè´£å›¾åƒ
    \item \textbf{æ™ºèƒ½åˆ†æ‰¹å¤„ç†}ï¼šçªç ´ VLM å›¾ç‰‡æ•°é‡é™åˆ¶
    \item \textbf{å®Œå–„çš„é”™è¯¯å¤„ç†}ï¼šä¼˜é›…é™çº§ç¡®ä¿ç³»ç»Ÿç¨³å®š
    \item \textbf{çµæ´»çš„é…ç½®æœºåˆ¶}ï¼šæ”¯æŒå¤šç§ VLM æä¾›å•†åˆ‡æ¢
    \item \textbf{ä¸ªæ€§åŒ–æ•™å­¦}ï¼šæ ¹æ®ç”¨æˆ·æ°´å¹³è°ƒæ•´å›ç­”é£æ ¼
\end{enumerate}

\vspace{1cm}
\begin{center}
\textcolor{primaryblue}{\Large ğŸ‰ é¡¹ç›®æˆåŠŸè¿è¡Œï¼}
\end{center}

\end{document}
